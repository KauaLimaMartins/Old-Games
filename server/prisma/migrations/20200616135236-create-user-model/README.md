# Migration `20200616135236-create-user-model`

This migration has been generated by KauaLimaMartins at 6/16/2020, 1:52:37 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."users" (
"email" text  NOT NULL ,"id" SERIAL,"name" text  NOT NULL ,"password_hash" text  NOT NULL ,"whatsapp" text  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."games" DROP COLUMN "email",
DROP COLUMN "owner",
DROP COLUMN "whatsapp",
ADD COLUMN "owner_id" integer  NOT NULL ;

CREATE UNIQUE INDEX "users.email" ON "public"."users"("email")

ALTER TABLE "public"."games" ADD FOREIGN KEY ("owner_id")REFERENCES "public"."users"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200606155206-oldgames..20200616135236-create-user-model
--- datamodel.dml
+++ datamodel.dml
@@ -1,38 +1,46 @@
 generator client {
-  provider = "prisma-client-js"
+    provider = "prisma-client-js"
 }
 datasource db {
-  provider = "postgresql"
-  url = "***"
+    provider = "postgresql"
+    url      = env("DATABASE_URL")
 }
 model consoles {
-  id             Int              @default(autoincrement()) @id
-  image          String
-  title          String
-  games_consoles games_consoles[]
+    id             Int              @default(autoincrement()) @id
+    image          String
+    title          String
+    games_consoles games_consoles[]
 }
 model games {
-  city             String
-  email            String
-  game_description String
-  game_name        String
-  id               Int              @default(autoincrement()) @id
-  image            String
-  latitude         Float
-  longitude        Float
-  owner            String
-  uf               String
-  whatsapp         String
-  games_consoles   games_consoles[]
+    city             String
+    game_description String
+    game_name        String
+    id               Int              @default(autoincrement()) @id
+    image            String
+    latitude         Float
+    longitude        Float
+    owner_id         Int
+    uf               String
+    users            users            @relation(fields: [owner_id], references: [id])
+    games_consoles   games_consoles[]
 }
 model games_consoles {
-  console_id Int
-  game_id    Int
-  id         Int      @default(autoincrement()) @id
-  consoles   consoles @relation(fields: [console_id], references: [id])
-  games      games    @relation(fields: [game_id], references: [id])
+    console_id Int
+    game_id    Int
+    id         Int      @default(autoincrement()) @id
+    consoles   consoles @relation(fields: [console_id], references: [id])
+    games      games    @relation(fields: [game_id], references: [id])
 }
+
+model users {
+    id            Int     @default(autoincrement()) @id
+    name          String
+    email         String  @unique
+    whatsapp      String
+    password_hash String
+    games         games[]
+}
```


